from company.prompt.outline.generate_outline_base_part import FORMAT_OUTLINE_PROMPT_PART

# 一个专业的[角色定义]
# 核心能力
# - 能力1
# - 能力2
# - 能力3
# 行为准则
# - 始终保持[特定风格]
# - 遵循[特定规范]
# - 禁止[特定行为]
# 输出格式
# - 使用[特定格式]
# - 包含[必要元素]
SYSTEM_PROMPT_OUTLINE_PART_EDIT_PART = f"""
你是一位顶级金融分析师和研报撰写专家，善于结构化、分段规划输出，分段大纲必须用```yaml包裹，便于后续自动分割。
"""


# ### 《金字塔原理》应用
# 1. **结论先行**：每个章节都要先明确核心观点
# 2. **以上统下**：上层观点是下层观点的概括
# 3. **归类分组**：同层级观点按逻辑关系分组
# 4. **逻辑递进**：同组观点按重要性或时间顺序排列
#
# ### 五大核心要求
# 1. **观点清晰**：标题必须是本段落观点和内容的高度概括
# 2. **金字塔结构**：严格按照金字塔原理组织内容层次
# 3. **逻辑一致**：内容之间不得相互矛盾，标题与内容完全匹配
# 4. **聚焦深入**：着眼点要小而精，避免无用内容，追求深度分析
# 5. **工整美观**：标题保持对仗工整，长度统一，结构美观


# 任务背景：[具体情境描述]
# 具体需求：
# 1.[明确的任务目标]
# 2.[具体的要求细节]
# 3.[期望的输出格式]
# 约束条件：
# - [特定限制]
# - [质量要求]



USER_PROMPT_OUTLINE_EDIT_PART_AI = f"""
# 商汤科技深度研报大纲生成
## 核心任务
你是一位资深金融分析师，需要为商汤科技生成专业的深度研报大纲。

## 关键规则（必须严格遵守）
### 1. has_sub_parts字段设置规则
核心原则：先生成完整大纲，再逐一检查每个节点 判断步骤：

1. 查看当前节点编号（如"1"、"1.1"、"2.1"）
2. 在整个大纲中搜索是否存在以"当前编号."开头的子编号
3. 如果找到子编号 → has_sub_parts: '有'
4. 如果没找到子编号 → has_sub_parts: '无'
具体示例：

- 节点"1"：如果大纲中有"1.1"、"1.2" → has_sub_parts: '有'
- 节点"1"：如果大纲中没有"1.1" → has_sub_parts: '无'
- 节点"1.1"：如果大纲中有"1.1.1"、"1.1.2" → has_sub_parts: '有'
- 节点"1.1"：如果大纲中没有"1.1.1"等 → has_sub_parts: '无'
### 2. 结构完整性要求
- 只有在内容逻辑上确实需要细分时才设置子节点
- 避免为了设置子节点而强行拆分内容
- 保持大纲的自然逻辑性和可读性
- 如果某节点has_sub_parts为'有'，必须在大纲中体现对应的子节点
- 层级控制：章(1) → 节(1.1) → 目(1.1.1)，最多三级
- 避免单一子节点的情况（如2.1下只有2.1.1）
### 3. 内容覆盖要求
必须包含以下核心要素：

- 宏观环境与行业分析
- 公司基本面分析（商业模式、技术壁垒、管理团队）
- 财务分析（盈利能力、现金流、成长性）
- 同业对比分析
- 估值预测（多种方法交叉验证）
- 投资建议与风险提示
- 数据来源标注
## 输出格式要求
- 以yaml格式输出，务必用 yaml和 包裹整个yaml内容
- yaml的值需要用单引号包起来，例如 part_title: '标题'
### 字段定义（每一项必须包含以下字段）
- has_sub_parts: 是否有子编号（'有'/'无'）
- part_num: 序号（例如 '1', '1.1', '1.1.1'）
- part_title: 标题（格式："序号. 标题名称"）
- part_title_type: 层级类型（'章'/'节'/'目'）
- part_desc: 本部分内容简介（60-100字）
- part_content_type: 内容性质（例如：理论铺垫、数据论证、基础定义等）
- part_key_output: 关键结论或成果（60-100字）
- part_data_source: 数据/资料来源
- part_importance: 重要性（'核心'/'次要'/'辅助'）
- part_length_ratio: 篇幅占比（例如：'10%-15%'）
## 🔍 生成后自检清单
生成完成后，请按以下步骤验证： 步骤1：检查has_sub_parts字段 □ 遍历每个节点，确认has_sub_parts设置正确
□ 所有设置为'有'的节点都有对应子节点
□ 所有设置为'无'的节点都没有子节点

步骤2：检查结构完整性 □ 每个章节至少有2个子节点
□ 层级关系清晰合理
□ 没有孤立的单一子节点

步骤3：检查内容覆盖 □ 所有必需的研报要素都已覆盖
□ 篇幅分配合理
□ 数据来源明确

## 大纲框架要求
使用券商深度研报框架，核心逻辑：宏观环境→行业景气→公司价值→投资策略。
层级清晰：使用 "章 - 节 - 目" 三级结构（如 "1.1.1 XXX"），避免层级混乱。
重点突出：核心章节（如 "实证分析""案例论证"）分配更多篇幅，细化子问题。

## 质量标准
1. 专业性：使用准确的金融术语和分析方法
2. 实用性：提供具体可操作的投资建议
3. 前瞻性：包含对未来趋势的预判
4. 完整性：覆盖所有必要的分析维度
5. 可读性：结构清晰，逻辑流畅
## 背景说明
本报告基于自动化采集与分析流程，涵盖如下环节：

- 公司基础信息等数据均通过akshare、公开年报、主流财经数据源自动采集
- 财务三大报表数据来源：东方财富-港股-财务报表-三大报表
- 主营业务信息来源：同花顺-主营介绍
- 股东结构信息来源：同花顺-股东信息，通过网页爬虫技术自动采集
- 行业信息通过DuckDuckGo等公开搜索引擎自动抓取，引用了权威新闻、研报、公司公告等
- 财务分析、对比分析、估值与预测均由大模型自动生成，结合了行业对标、财务比率、治理结构等多维度内容
- 相关数据与分析均在脚本自动化流程下完成，确保数据来源可追溯、分析逻辑透明
## 特别提醒
- 生成过程中，优先确保结构逻辑正确
- has_sub_parts字段是最容易出错的地方，请特别注意
- 如有疑问，宁可多设子节点也不要设置错误的has_sub_parts
- 重要：生成完整大纲后，必须逐一检查每个节点的has_sub_parts字段是否与实际子节点存在情况一致
"""


USER_PROMPT_OUTLINE_EDIT_PART = f"""
你是一位顶级金融分析师和研报撰写专家。请基于以下背景和财务研报汇总内容，生成一份详尽的《{{target_company}}研报》分段大纲，
{FORMAT_OUTLINE_PROMPT_PART}
【财务研报汇总内容开始】
{{report_data}}
【财务研报汇总内容结束】
"""


# ## 数据输入要求
# 【公司基础信息】

# {在此处提供：公司全称、股票代码、上市地点、主营业务、成立时间等基础信息}
#
# 【财务数据】
# {在此处提供：近3-5年的关键财务数据，包括营收、净利润、资产负债表主要科目、现金流等}
#
# 【行业背景】
# {在此处提供：所属行业发展现状、市场规模、增长趋势、政策环境等}
#
# 【竞争对手信息】
# {在此处提供：主要竞争对手名单及基本对比数据}
#
# 【最新动态】
# {在此处提供：公司最新公告、业务进展、市场表现等}
#
# 【背景说明】
# {数据来源说明、采集方法、分析工具等}
#
# ## 约束条件
# ### 结构设计原则
# 1. 金字塔逻辑 ：采用结论先行、层次分明的逻辑结构
# 2. 观点鲜明 ：每个章节都要有清晰的核心观点
# 3. 逻辑一致 ：各章节间观点和数据保持一致性
# 4. 内容聚焦 ：避免冗余，每个部分都有独特价值
# 5. 格式规范 ：标题层次清晰，编号统一
# ### 创新性要求
# 1. 章节命名创新 ：可以使用更具吸引力和针对性的章节标题
# 2. 结构安排灵活 ：根据公司特点和投资逻辑调整章节顺序
# 3. 分析角度独特 ：体现差异化的研究视角和投资洞察
# 4. 内容深度适配 ：根据公司类型和行业特点调整分析重点
# ### 质量标准
# 1. 专业性 ：使用准确的金融术语和分析方法
# 2. 实用性 ：提供具体可操作的投资建议
# 3. 前瞻性 ：包含对未来趋势的预判
# 4. 完整性 ：覆盖所有必要的分析维度
# 5. 可读性 ：结构清晰，逻辑流畅

USER_PROMPT_OUTLINE_EDIT_MODIFY_PART = f"""
你是一位顶级金融分析师和研报撰写专家。请基于以下背景和财务研报汇总内容，修改一份详尽的《{{target_company}}研报》分段大纲，
{FORMAT_OUTLINE_PROMPT_PART}
【修改大纲内容】
{{report_outline}}
【修改建议】
{{report_outline_opinion}}
【财务研报汇总内容开始】
{{report_data}}
【财务研报汇总内容结束】
"""

# ### 公司基础信息
# - 公司全称：[请填写]
# - 股票代码：[请填写]
# - 所属行业：[请填写]
# - 主营业务：[请填写]
# - 市值规模：[请填写]
# - 研报类型：[首次覆盖/深度报告/跟踪报告]
# - 公司特点：[如成长股/价值股/周期股/新兴行业等]
# ### 分析重点与特色要求
# 请根据以下信息进行个性化分析：
#
# - 核心投资主题 ：[如数字化转型、出海战略、技术创新等]
# - 关键分析角度 ：[如盈利模式变化、市场份额提升、成本优化等]
# - 重点关注领域 ：[如新产品发布、政策影响、行业变革等]
# - 差异化视角 ：[请提出独特的分析角度或市场关注点]
# - 目标读者 ：[如机构投资者、个人投资者、行业研究员等]
# 标准
# https://finance.sina.com.cn/stock/stockzmt/2024-11-11/doc-incvsyzf7238509.shtml
# https://stock.hexun.com/2024-05-13/212819524.html
# 数据源
# https://zhuanlan.zhihu.com/p/481982573
# 字体要求
# https://www.sse.com.cn/aboutus/publication/actofcourt/editstyle/

# 如何写
# https://www.zhihu.com/question/50189615